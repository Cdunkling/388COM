# AdapterViews and Fragments

Last week we looked at some 'simple' widgets and layouts. Simple here refers to the fact that those widgets are mainly used to display/collect small amount static data. What if the data are of large quantity or dynamically generated? Shall we put say 20 headlines from a newspaper in TextViews one after another? Obviously the answer is no here. Let's find out how.

## Lab 1 AdapterViews

We have looked at Spinner, which is a special case i.e. subclass of AdapterView. In order to make it work, we had to combine three elements: the View itself (Spinner), the data resouse which is typically a Collection (interface), an Adaptor that bines every *single entry* in the Collection with its layout. 

![adaptor components](http://cdn.edureka.co/blog/wp-content/uploads/2013/03/adapters-1.png)

Now let's look at some more subclasses of AdapterView.

### Simple ListView
Start a new Android Studio project called “My Lists” using all default options. Under the text view of you layout xml file you should have the default RelativeLayout and TextView generated by the system. Leave them as they are.

Now open the MainActivity.java file, make sure your Activity class extends the ListActivity super class, as follows:



In this way, out MainActivity class is a sub-class of ListActivity. The advantage of this approach is that we have setListAdapter and onListItemClick methods built-in with activity class. Now insert the following code into file, just after the class declaration. This will give us some data to play with.



Next, modify the onCreate method to make it look like the following. Note that the line with setContentView has been commented out.



Now if you run the app, you’ll see that a list pops up on your AVD. But it doesn’t respond to click or any other gestures – We’ll need to implement callback functions for that. But before we do that, try to uncomment the setContentView line and run the app, what happens? And Why?

Hint: ListActivity has a default layout that consists of a single, full-screen list in the center of the screen. However, if you desire, you can customize the screen layout by setting your own view layout with setContentView() in onCreate(). To do this, your own view MUST contain a ListView object with the id "@android:id/list" (http://developer.android.com/reference/android/app/ListActivity.html)

In order to respond to item click event, we need to implement the onListItemClick listener as follows:


For some reasons, Android Studio doesn’t provide a signature hint for this method (as opposed to most other methods). So if you can’t remember what input parameters are, you need to go to the API guide at the URL above.

Now if you run the app and click on one of the names, you’ll see something similar to the one below:

   

Next, open strings.xml file, located under appresvalues folder (see above). Insert the following code in between the <resources> tags:



Go back to your java source code i.e. MainActivity.java and comment out the string array definition:

1.	Select the source code that defines presidents
2.	While those lines are selected, select CodeComment wit Line Comment
  

3.	Insert the variable declaration of presidents before the onCreate method. So it looks like:



4.	In the onCreate method, insert the getResources line to get the string array.



If we put the getResources line outside of the onCreate method, what will happen?



### Complex list view


Create the data
Now we’re going to build a complex list view using custom adaptors based on the project we created earlier. Locate where you save ‘My Lists’ on your hard drive, copy and paste the entire folder, rename it ‘MyListComplex’. Close your Android Studio project (if you have anything open), select “Import Non-Android Studio project” and navigate to where ‘MyListComplex’ is and import. Note here if you choose “Open an existing Android Studio project” you won’t be able to find your java files.

Uncomment the String array, and rename is presidentsFullName. Rename the empty array declaration as presidentsFirstName, and comment out the setListAdapter line. So now your first part of the code should look like this:


Now right click on the package name (where it says com.example.xxxx.mylists), and select NewJava Class and choose the “main/java” folder, name your class Presidents.

           

If your class is not within the package, you’ll need to move the file into your package, like this:



Now make the following changes to your class so that we can use it later. This is fairly basic stuff.



Right click on the ‘private String firstName’ line and select ‘Generate…’, select ‘Setter and Getter’, select both variables to generate the setter and getter methods.


Next, we add an ArrayList into our project to form the data our complex list view is based on. You’ll need to declare an ArrayList, put the presidents details in it, and also change the way we query the data. 

1.	Declare an array list just after the declaration of presidentsFirstName


2.	In the onCreate method, add the following lines of code.


3.	Change the array indexing in the onListItemClick method to array list indexing. Basically it was presidents[position], and should now be changed to 



Build the layout
Create a new layout xml file, and name it list_item.xml.


Drag and drop to Plain TextViews onto it, give IDs of firstName and fullName, like below. Now we’re ready to go into the most important part of the exercise.



Custom adaptor
This is the most important part of the exercise. Now you need to create an adaptor to link the data with the view. Create a java class and name it PresidentsAdaptor. Put the following lines of code in it so it looks like:



Its important to understand what the code does: out PresidentsAdaptor class extends ArrayAdapter of type Presidents. In the constructor we give the layout resource name i.e. the file that contains the custom layout. The most important method is getView, where we check if a convertView (i.e. old view) exists or not. If it doesn’t, we’ll need to inflate it. Make sure you understand every single line of code. If you don’t, try to get some help from me or your colleagues.
Next, we go to MainActivity class and change the setListAdapter method to the following:



Now if you run the app, what you’ll see is something similar to below:


### Grid View

Create a new project, give it a name like “My Grids”. Download some images from http://developer.android.com/shareables/sample_images.zip, extract and pastes those images into your drawable folder. The folder is at <project root>appsrcmainresdrawable. Now under the “Android” view within Android Studio those images should appear too.

                         

Now replace the contents of activity_main.xml with the following:

           

Note that as opposed to RelativeLayout and LinearLayout, GridView is not a container view i.e. no other views in between its tags. Now your layout should look like the image above.

Next, modify the onCreate method and make it look like the following image. This now looks familiar as it’s the same as in the ListView.



What is missing here is the most important part i.e. the adaptor class. Now create a new class called ImageAdapter. To save you some time, you can copy/paste the following code into this new java file to replace what’s in there already:

//////////////////////////////////////////-------------BEGIN------------------------
public class ImageAdapter extends BaseAdapter {
    private Context mContext;

    public ImageAdapter(Context c) {
        mContext = c;
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    // create a new ImageView for each item referenced by the Adapter
    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imageView;
        if (convertView == null) {  // if it's not recycled, initialize some attributes
            imageView = new ImageView(mContext);
            imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(8, 8, 8, 8);
        } else {
            imageView = (ImageView) convertView;
        }



        imageView.setImageResource(mThumbIds[position]);
        return imageView;
    }

    // references to our images
    private Integer[] mThumbIds = {
            R.drawable.sample_2, R.drawable.sample_3,
            R.drawable.sample_4, R.drawable.sample_5,
            R.drawable.sample_6, R.drawable.sample_7,
            R.drawable.sample_0, R.drawable.sample_1,
            R.drawable.sample_2, R.drawable.sample_3,
            R.drawable.sample_4, R.drawable.sample_5,
            R.drawable.sample_6, R.drawable.sample_7,
            R.drawable.sample_0, R.drawable.sample_1,
            R.drawable.sample_2, R.drawable.sample_3,
            R.drawable.sample_4, R.drawable.sample_5,
            R.drawable.sample_6, R.drawable.sample_7
    };
}
//////////////////////////////////////////--------------END-----------------------

Some detailed explanations of this file can be found at http://developer.android.com/guide/topics/ui/layout/gridview.html. Make sure you understand every single bit of it as this is very important. Now if you run this app what you’ll see is similar to the image above.







**Contents**

Simple listview, complex listview, adapter view, Grid view

**Refs**

[Ref.[4]](#ref4) chapter 4

[Android official API guide: List View ](http://developer.android.com/guide/topics/ui/layout/listview.html)

## Lab 2 Fragments

**Contents**

Fragments, specialized fragments, screen orientation

**Refs**

[Ref.[4]](#ref4) chapter 4



## Lab 3 Advanced topics

For those of you who haven't completed previous labs, you can work on it if you wish. For those who have finished, in this final lab I'll ask some challenging questions for you to explore. These questions are related to previous labs, and somehow involves more efforts to complete.

### Build from command line


![adaptor components](.md_images/done.png)
